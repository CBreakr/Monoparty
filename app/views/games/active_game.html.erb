<%# 
Banner at the top with messages

The main idea is to have the board as in the template
but in the middle is a space in which buttons for user actions can appear\
    - the spaces would have their color, text, user_pieces, and ownership customized
        - including where the border is placed
    - but their placement and shape would be by default

with info panels for the different players
    - cheat with a little bit of javascript for going between the tabs
        - and/or collapse/expand
%>

<% sorted_spaces = @game.get_sorted_spaces %>
<% side_length = sorted_spaces.count/4 + 1 %>

<% scale_factor = 40.0/sorted_spaces.count %>

<%#

oh, I need to figure out the indexes to use
because I can't place these in order (1 is the last space put into place)

so I want a method that will put these into the necessary order

TOP ROW: 2*side_length -1 TO 3*side_length-2

then 2*side_length-2 & 3*side_length-1

to

then side_length+1 & 4*side_length - 4

BOTTOM ROW: side_length to 1

        <tr>
            <td></td>
            side_length-2 times
            <td></td>
        </tr>

        <tr>
            <td></td>
            <td colspan=(side_length-2) rowspan=(side_length-2)></td>
            <td></td>
        </tr>

        side_length-3 times
        <tr>
            2 times
            <td></td>
        </tr>

        <tr>
            <td></td>
            side_length-2 times
            <td></td>
        </tr>
%>

<div class="game_container">
    <div class="board_container">
        <table border="3" cellspacing="0" cellpadding="3" style="text-align:center;font:normal 8pt/9pt arial;width:90vh;border-collapse:separate; background-color:#F0FFF0;">
            <tbody>
                <% display_spaces = @game.get_placement_spaces %>
                <% count = 1 %>
                <% total = display_spaces.count %>
                <% side_length = (1 + total/4) %>

                <tr>
                    <%= render partial: "spaces/display_space_cell", locals: {game: @game, gs: display_spaces[count-1], border_side: "bottom", size_style: "height:12vh;width:12vh;"} %>
                    <% count += 1 %>
                    <% (side_length-2).times do %>
                        <%= render partial: "spaces/display_space_cell", locals: {game: @game, gs: display_spaces[count-1], border_side: "bottom", size_style: ""} %>
                        <% count += 1 %>
                    <% end %>
                    <%= render partial: "spaces/display_space_cell", locals: {game: @game, gs: display_spaces[count-1], border_side: "bottom", size_style: "height:12vh;width:12vh;"} %>
                    <% count += 1 %>
                </tr>

                <tr>
                    <%= render partial: "spaces/display_space_cell", locals: {game: @game, gs: display_spaces[count-1], border_side: "right", size_style: "height:6.5vh;"} %>
                    <% count += 1 %>
                    <td colspan="<%= side_length-2 %>" rowspan="<%= side_length-2 %>">                    
                        <%= button_to "Roll Dice", roll_dice_path(@game) %>
                    </td>
                    <%= render partial: "spaces/display_space_cell", locals: {game: @game, gs: display_spaces[count-1], border_side: "left", size_style: "height:6.5vh;"} %>
                    <% count += 1 %>
                </tr>

                <% (side_length-3).times do %>
                <tr>
                    <%= render partial: "spaces/display_space_cell", locals: {game: @game, gs: display_spaces[count-1], border_side: "right", size_style: "height:6.5vh;"} %>
                    <% count += 1 %>
                    <%= render partial: "spaces/display_space_cell", locals: {game: @game, gs: display_spaces[count-1], border_side: "left", size_style: "height:6.5vh;"} %>
                    <% count += 1 %>
                </tr>
                <% end %>

                <tr>
                    <%= render partial: "spaces/display_space_cell", locals: {game: @game, gs: display_spaces[count-1], border_side: "top", size_style: "height:12vh;width:12vh;"} %>
                    <% count += 1 %>
                    <% (side_length-2).times do %>
                        <%= render partial: "spaces/display_space_cell", locals: {game: @game, gs: display_spaces[count-1], border_side: "top", size_style: ""} %>
                        <% count += 1 %>
                    <% end %>
                    <%= render partial: "spaces/display_space_cell", locals: {game: @game, gs: display_spaces[count-1], border_side: "top", size_style: "height:12vh;width:12vh;"} %>
                    <% count += 1 %>
                </tr>

                <tr>
                    <td colspan="11">AAAAAAAAAAAAAAAAAAAAAAAA<br />AAAAAAAAAAAAAAAAAAAAAAAA</td>
                </tr>
                <tr>
                    <td style="height:12vh;width:12vh;">Free Parking
                    </td>

                    <td style="border-bottom:solid 12px Red">Kentucky Avenue<br>$220</td>
                    <td style="">Chance</td>
                    <td style="border-bottom:solid 12px Red">Indiana Avenue<br>$220</td>
                    <td style="border-bottom:solid 12px Red">Illinois Avenue<br>$240</td><td style="">B&amp;O Railroad<br>$200</td>
                    <td style="border-bottom:solid 12px Yellow">Atlantic Avenue<br>$260</td>
                    <td style="border-bottom:solid 12px Yellow">Ventnor Avenue<br>$260</td>
                    <td style="">Water Works<br>$150</td>
                    <td style="border-bottom:solid 12px Yellow">Marvin Gardens<br>$280</td>

                    <td style="width:12vh;">Go To Jail
                    </td>
                </tr>
                <tr>
                    <td style="height:6.5vh;border-right:solid 12px Orange">New York Avenue<br>$200</td>
                    <td rowspan="9" colspan="9" align="center">
                    </td>
                    <td style="border-left:solid 12px Green">Pacific Avenue<br>$300</td>
                </tr>
                <tr>
                    <td style="height:6.5vh;border-right:solid 12px Orange">Tennessee Avenue<br>$180</td>
                    <td style="border-left:solid 12px Green">North Carolina Avenue<br>$300</td>
                </tr>
                <tr>
                    <td style="height:6.5vh;">Community Chest</td>
                    <td style="">Community Chest</td>
                </tr>
                <tr>
                    <td style="height:6.5vh;border-right:solid 12px Orange">St. James Place<br>$180</td>
                    <td style="border-left:solid 12px Green">Pennsylvania Avenue<br>$320</td>
                </tr>
                <tr>
                    <td style="height:6.5vh;">Pennsylvania Railroad<br>$200</td>
                    <td style="">Short Line<br>$200</td>
                </tr>
                <tr>
                    <td style="height:6.5vh;border-right:solid 12px DarkOrchid">Virginia Avenue<br>$160</td>
                    <td style="">Chance</td>
                </tr>
                <tr>
                    <td style="height:6.5vh;border-right:solid 12px DarkOrchid">States Avenue<br>$140</td>
                    <td style="border-left:solid 12px Blue">Park Place<br>$350</td>
                </tr>
                <tr>
                    <td style="height:6.5vh;">Electric Company<br>$150</td>
                    <td style="">Luxury Tax<br>(pay $100)</td>
                </tr>
                <tr>
                    <td style="height:6.5vh;border-right:solid 12px DarkOrchid">St. Charles Place<br>$140</td>
                    <td style="border-left:solid 12px Blue">Boardwalk<br>$400</td>
                </tr>
                <tr>
                    <td style="height:12vh;">In Jail/Just Visiting</td>
                    <td style="border-top:solid 12px SkyBlue">Connecticut Avenue<br>$120</td>
                    <td style="border-top:solid 12px SkyBlue">Vermont Avenue<br>$100</td>
                    <td style="">Chance</td>
                    <td style="border-top:solid 12px SkyBlue">Oriental Avenue<br>$100</td>
                    <td style="">Reading Railroad<br>$200</td>
                    <td style="">Income Tax<br>(pay $200)</td>
                    <td style="border-top:solid 12px SaddleBrown">Baltic Avenue<br>$60</td>
                    <td style="">Community Chest</td>
                    <td style="border-top:solid 12px SaddleBrown">Mediter-ranean Avenue<br>$60</td>
                    <td><b>Go</b><br>(collect $200)<br><a href="/wiki/File:Monopoly_Go_Arrow.png" class="image"><img alt="Monopoly Go Arrow.png" src="//upload.wikimedia.org/wikipedia/commons/thumb/9/96/Monopoly_Go_Arrow.png/44px-Monopoly_Go_Arrow.png" decoding="async" width="44" height="8" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/9/96/Monopoly_Go_Arrow.png/66px-Monopoly_Go_Arrow.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/9/96/Monopoly_Go_Arrow.png/88px-Monopoly_Go_Arrow.png 2x" data-file-width="793" data-file-height="151"></a></td>
                </tr>
            </tbody>
        </table>
        
        <br />
        <% sorted_spaces.each do |gs| %>
            <div>
                <%= gs.space.space_name %>: <%= gs.position %>
                <br />
                <% @game.player_games.each do |pg| %>
                    <% if !pg.has_conceded && pg.current_position == gs.position %>
                        <span class="player_piece" style="color: white; border: 1px solid black; display: inline-block; height:3vh; width: 3vh; background-color:blue">
                            <%= pg.turn_order %>
                        </span>
                    <% end%>
                <% end %>
            </div>
        <% end %>
    </div>

    <div class="player_container">
        <p>
            <%= @game.turn_count %> out of <%= Game::TURN_LIMIT %>
        </p>

        <% @game.sorted_player_games.each do |pg| %>
            <p class = "distinct">
                <% if pg.is_current_turn %>
                CURRENT TURN
                <br />
                <% end %>
                <% if pg.has_conceded %>
                OUT OF THE GAME
                <% end %>
                <%= pg.player.player_name %>
                <br />
                <%= pg.turn_order %>
                <br />
                $<%= pg.money %>
                <br />
                <%= pg.current_position%>
            </p>
        <% end %>
    </div>
</div>